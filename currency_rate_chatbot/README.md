# currency-rate-bot
- 기준 통화 대비 원화 환율을 제공합니다.
- 기준 통화와 금액을 입력하여 환산 금액을 조회할 수 있습니다.

## 목차
1. [기술 스펙](#기술-스펙)
2. [API](#api)
3. [요구 사항](#요구-사항)

## 기술 스펙
- IntelliJ IDEA 
- Spring Boot 2.1.7.RELEASE
- OpenJDK 1.8.0_222
- Gradle 5.4.1
- Lombok 1.18.8
- H2 1.4.199

## API
- [LINE Messaging API](https://developers.line.biz/en/docs/messaging-api/overview/)
    - [LINE Messaging API SDK for Java](https://github.com/line/line-bot-sdk-java)
    - [install the modules : Maven Central Repository](https://search.maven.org/search?q=g:com.linecorp.bot)

- [currencylayer API](https://currencylayer.com/)
  - 환율 정보를 제공하는 API
  - 무료 지원 내용
    - 250 Requests / month
    - Daily Updates
  - API에서 제공되는 데이터의 기준 통화는 모두 `USD`이기 때문에  
  `USDXXX`로 데이터를 가져와 DB에 저장한 후, DB에 저장된 데이터를 바탕으로 사용자의 요청에 해당하는 환율을 계산하여 제공한다.
  - (WIP)API 호출은 매일 밤 23시에 스케줄러를 통해 이루어진다.
    - API 호출 결과를 10분 주기로 체크하여 환율이 0이거나 하는 등의 비정상적인 값이 들어왔을 때 API를 재호출하도록 한다.

## 요구 사항
- ### 1. 환율 정보 조회
  - #### 1.1 사용자가 기준 통화를 입력할 수 있다.
    - KRW(원), USD(달러), JPY(엔), EUR(유로), CNY(위안), GBP(파운드), AUD(달러), CAD(달러), HKD(달러), THB(바트)
        - 대소문자를 모두 가능하다.
    - 보기에서 제공되지 않는 텍스트나 그 외(스티커 등) 입력 시, 예외 처리되며 `메뉴`를 입력하도록 가이드 한다.
  - #### 1.2 사용자가 상대 통화를 선택할 수 있다.
    - 기준 통화로 선택된 통화는 상대 통화의 보기에서 제외된다.
  - #### 1.3 사용자가 상대 통화를 선택하면, `기준 통화/상대 통화`의 환율 정보를 제공한다.
    - 환율은 소수점 둘째 자리까지 표기하며, 3자리 이상이 되면 콤마로 구분한다.
    - 최근 업데이트 시각을 명시한다. 
  - #### 1.4 기준 통화와 상대 통화가 정해진 후, 사용자는 금액을 입력할 수 있다.
    - 입력받는 금액이 자연수일 경우 `10자리까지`, 유리수일 경우 `정수부 8자리까지, 소수부 2자리까지`로 한정한다.
      - 사용자에게 제공되는 가이드 : `숫자는 총 10자리까지 가능하며, 소수점 이하는 2자리까지 지원합니다.`
      - 이 외의 숫자 포멧일 경우 금액을 재입력하도록 가이드한다.
      - 숫자 외 문자 포맷일 경우 예외 처리되며 `메뉴`를 입력하도록 가이드 한다.
    - 환산 금액은 소수점 둘째 자리까지 표기하며, 3자리 이상이 되면 콤마로 구분한다.
    - 최근 업데이트 시각을 명시한다.
      - 환율 데이터가 하루 이전 기준일 경우, 해당 내용을 사용자에게 제공한다.
        - e.g. `※ 참고 : 24시간 이전 데이터입니다.`
  - #### 1.5 환산 금액 제공 후, `Quick Reply`를 이용하여 `메뉴`로 돌아갈 수 있도록 가이드한다.
    - `다시 계산하기`, `환율 정보 조회`로 이동할 수 있도록 가이드한다.
- ### 2. 사용자가 초기 메뉴에 대한 명령어를 입력할 때, 유사 언어도 인식 가능하도록 한다.
  - e.g. `환율 정보 조회` -> `환율 조회`, `환율 정보` 등도 인식 가능
- ### 3. 사용자 입력에 대해 expire time이 적용된다.
  - 사용자 입력 후 `10분`이 지나면, 진행 중인 부분은 expire되고 초기 메뉴부터 진행된다.